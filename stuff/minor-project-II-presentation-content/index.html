<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="Henry: Heap Allocator Heap Allocator An allocator maintains the heap as a collection of various-size blocks. Each block is a contiguous chunk of virtual memory that is either allocated or free."><title>minor-project-II-presentation-content</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://aryana101a.github.io/digital_garden//icon.png><link href=https://aryana101a.github.io/digital_garden/styles.d2f738589684858118a26e4c88e3fef5.min.css rel=stylesheet><link href=https://aryana101a.github.io/digital_garden/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://aryana101a.github.io/digital_garden/js/darkmode.6d4fe0ca5b63f848ebeef87b162635d8.min.js></script>
<script src=https://aryana101a.github.io/digital_garden/js/util.9825137f5e7825e8553c68ce39ac9e44.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script src=https://unpkg.com/@floating-ui/core@0.7.3></script>
<script src=https://unpkg.com/@floating-ui/dom@0.5.4></script>
<script src=https://aryana101a.github.io/digital_garden/js/popover.37b1455b8f0603154072b9467132c659.min.js></script>
<script src=https://aryana101a.github.io/digital_garden/js/code-title.b35124ad8db0ba37162b886afb711cbc.min.js></script>
<script src=https://aryana101a.github.io/digital_garden/js/clipboard.c20857734e53a3fb733b7443879efa61.min.js></script>
<script src=https://aryana101a.github.io/digital_garden/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const BASE_URL="https://aryana101a.github.io/digital_garden/",fetchData=Promise.all([fetch("https://aryana101a.github.io/digital_garden/indices/linkIndex.56e7139c8929c45db9d4b1ada35d6bb2.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://aryana101a.github.io/digital_garden/indices/contentIndex.f60e5d1a237f6d17d19bbb58b7dee92d.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addCollapsibleCallouts(),initPopover("https://aryana101a.github.io/digital_garden",!0,!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!0;drawGraph("https://aryana101a.github.io/digital_garden",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2})}},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],throwOnError:!1})}</script><script>window.Million={navigate:e=>window.location.href=e,prefetch:()=>{}},window.addEventListener("DOMContentLoaded",()=>{init(),render()})</script></head><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://aryana101a.github.io/digital_garden/js/full-text-search.24827f874defbbc6d529926cbfcfb493.min.js></script><div class=singlePage><header><h1 id=page-title><a href=https://aryana101a.github.io/digital_garden/>ðŸª„ Hi, I'm Aryan</a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><h1>minor-project-II-presentation-content</h1><p class=meta>Last updated
Apr 24, 2023</p><ul class=tags></ul><a href=#henry-heap-allocator><h1 id=henry-heap-allocator><span class=hanchor arialabel=Anchor># </span>Henry: Heap Allocator</h1></a><a href=#heap-allocator><h3 id=heap-allocator><span class=hanchor arialabel=Anchor># </span>Heap Allocator</h3></a><p>An allocator maintains the heap as a collection of various-size blocks. Each
block is a contiguous chunk of virtual memory that is either allocated or free.</p><p>Dynamic memory allocators such as malloc can allocate or deallocate heap
memory explicitly by using the <code>mmap</code> and <code>munmap</code> syscall, or they can use the
<code>sbrk</code> syscall.</p><p><img src=/digital_garden/stuff/memory_layout.png width=auto></p><hr><a href=#allocators-come-in-two-basic-styles><h3 id=allocators-come-in-two-basic-styles><span class=hanchor arialabel=Anchor># </span>Allocators come in two basic styles.</h3></a><ol><li><p><strong>Explicit allocators</strong> require the application to explicitly free any allocated
blocks. For example, the C standard library provides an explicit allocator
called the malloc package.</p></li><li><p><strong>Implicit allocators</strong>, on the other hand, require the allocator to detect when
an allocated block is no longer being used by the program and then free
the block. Implicit allocators are also known as <strong>garbage collectors</strong>.
For example, higher-level languages such as Java rely
on garbage collection to free allocated blocks.</p></li></ol><hr><a href=#allocator-requirements><h3 id=allocator-requirements><span class=hanchor arialabel=Anchor># </span>Allocator Requirements</h3></a><ul><li>Handling arbitrary request sequences</li><li>Making immediate responses to requests.</li><li>Aligning blocks (alignment requirement).</li><li>Not modifying allocated blocks.</li></ul><a href=#goals><h3 id=goals><span class=hanchor arialabel=Anchor># </span>Goals</h3></a><ul><li>Maximizing throughput</li><li>Maximizing memory utilization</li></ul><hr><a href=#fragmentation><h3 id=fragmentation><span class=hanchor arialabel=Anchor># </span>Fragmentation</h3></a><p>The primary cause of poor heap utilization is a phenomenon known as fragmen-
tation</p><p><img src=/digital_garden/stuff/fragmentation.png width=auto></p><ol><li><p><strong>Internal fragmentation</strong> occurs when an allocated block is larger than the pay-
load.</p></li><li><p><strong>External fragmentation</strong> occurs when there is enough aggregate free memory
to satisfy an allocate request, but no single free block is large enough to handle
the request.</p></li></ol><p><em><strong>Trivia</strong>: The processors in modern 64-bit systems involve a lot of cool techniques to make execute instructions as fast as possible. One of which is <strong>Prefetching</strong>, a technique used in modern processors to improve performance by anticipating memory access patterns and starting to load data into cache before it is actually needed. This is the reason why we need to align memory allocations in the multiples of 16 bytes.</em></p><hr><a href=#implementation-issues><h3 id=implementation-issues><span class=hanchor arialabel=Anchor># </span>Implementation Issues</h3></a><ul><li><strong>Free block organization</strong>. How do we keep track of free blocks?</li><li><strong>Placement</strong>. How do we choose an appropriate free block in which to place a
newly allocated block?</li><li><strong>Splitting</strong>. After we place a newly allocated block in some free block, what do
we do with the remainder of the free block?</li><li><strong>Coalescing</strong>. What do we do with a block that has just been freed?</li></ul><hr><a href=#implicit-free-lists><h3 id=implicit-free-lists><span class=hanchor arialabel=Anchor># </span>Implicit Free Lists</h3></a><p><img src=/digital_garden/stuff/implicit-list-heap-block-format.png width=auto></p><p><img src=/digital_garden/stuff/implicit-list.png width=auto></p><hr><a href=#placing-allocated-blocks><h4 id=placing-allocated-blocks><span class=hanchor arialabel=Anchor># </span>Placing Allocated Blocks</h4></a><ul><li><strong>First fit</strong> searches the free list from the beginning and chooses the first free
block that fits.</li><li><strong>Next fit</strong> is similar to first fit, but instead of starting each search at
the beginning of the list, it starts each search where the previous search left off.</li><li><strong>Best fit</strong> examines every free block and chooses the free block with the smallest size
that fits.</li></ul><hr><a href=#timelineroadmap><h3 id=timelineroadmap><span class=hanchor arialabel=Anchor># </span>Timeline/Roadmap</h3></a><p><strong>P1</strong>: Knowledge Gathering and Prerequisite Study
<strong>P2</strong>: Implicit Freelist Implementation
<strong>P3</strong>: Binned Freelist/Segregated Freelist Implementation</p><hr><a href=#implicit-freelist-organization><h3 id=implicit-freelist-organization><span class=hanchor arialabel=Anchor># </span>Implicit Freelist Organization</h3></a><p><img src="/digital_garden/stuff/Pasted image 20230424225017.png" width=auto>
<img src="/digital_garden/stuff/Pasted image 20230424224955.png" width=auto></p><hr><a href=#coalescing-free-blocks><h3 id=coalescing-free-blocks><span class=hanchor arialabel=Anchor># </span>Coalescing Free Blocks</h3></a><p><img src="/digital_garden/stuff/Pasted image 20230424224639.png" width=auto>
<img src="/digital_garden/stuff/Pasted image 20230424224709.png" width=auto>
<img src="/digital_garden/stuff/Pasted image 20230424224722.png" width=auto>
<img src="/digital_garden/stuff/Pasted image 20230424224734.png" width=auto></p><hr><a href=#implementation><h3 id=implementation><span class=hanchor arialabel=Anchor># </span>Implementation</h3></a><p>Lets have a look at some real code ðŸ«¡</p><p><strong>Refrences</strong></p><ul><li><a href=https://web.stanford.edu/class/archive/cs/cs107/cs107.1186/assign7/ rel=noopener>Boilerplate and testfiles/scripts taken from Stanford cs107 assignment 7 (class of 2018)</a></li><li><a href=https://csapp.cs.cmu.edu/ rel=noopener>Computer Systems : A programmer&rsquo;s perspective</a></li></ul><hr></article><hr><div class=page-end id=footer><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li><a href=/digital_garden/stuff/stuff/ data-ctx="Minor Project II Presentation Content" data-src=/stuff/stuff class=internal-link>Stuff</a></li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://aryana101a.github.io/digital_garden/js/graph.abd4bc2af3869a96524d7d23b76152c7.js></script></div></div><div id=contact_buttons><footer><p>Made by Aryan Arora using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, Â© 2023</p><ul><li><a href=https://aryana101a.github.io/digital_garden/>Home</a></li><li><a href=https://www.linkedin.com/in/aryanar0ra/>Linkedin</a></li><li><a href=https://github.com/aryanA101a>Github</a></li></ul></footer></div></div></body></html>